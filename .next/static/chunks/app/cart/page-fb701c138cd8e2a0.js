(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{6579:function(e,t,s){Promise.resolve().then(s.bind(s,197))},197:function(e,t,s){"use strict";s.r(t);var l=s(7437),a=s(2265),r=s(3383);t.default=()=>{let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(""),[c,i]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[m,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{t(JSON.parse(localStorage.getItem("cart"))||[]),h(!1)})()},[]);let b=s=>{let l=e.filter((e,t)=>t!==s);t(l),localStorage.setItem("cart",JSON.stringify(l))},f=e=>{confirm("هل أنت متأكد أنك تريد إزالة هذا العنصر من سلة التسوق؟")&&b(e)},g=()=>e.reduce((e,t)=>e+t.price*(t.quantity||1),0),p=async l=>{l.preventDefault();let a={_type:"order",name:s,address:c,phoneNumber:o,items:e.map((e,t)=>({key:e.index,_type:"orderItem",productName:e.title||"منتج بدون اسم",productRef:{_type:"reference",_ref:e._id},quantity:e.quantity||1,price:e.price,totalPrice:e.price*(e.quantity||1)})),totalOrderPrice:g()};try{await r.Lp.create(a,{token:"skMuyw0al2locWT7DGTeGftHSEEIlQcWaykJV8J6qdXxVQrjouuBIEmlFGNTBOWuI0LFmIrRMN3RjEQsbFThTGkG9UqLKbm8aZncweW8nK17NSwco4hU9DNU0mxMSyrKFs2OObhyfoow1MtNlWQsoSKthTquglxVauiK8ecpCF3cgIO2pbZT"}),localStorage.removeItem("cart"),t([]),u(!0),console.log("تم تقديم الطلب بنجاح")}catch(e){console.error("خطأ في إنشاء الطلب:",e)}};return(0,l.jsx)("div",{className:"max-w-screen-lg mx-auto p-4 rtl",children:x?(0,l.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,l.jsx)("div",{className:"loader"})}):(0,l.jsxs)("div",{children:[m&&(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,l.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-4",children:"تم تقديم الطلب بنجاح!"}),(0,l.jsx)("p",{className:"mb-4",children:"شكرًا على الشراء."}),(0,l.jsx)("button",{onClick:()=>{u(!1)},className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"إغلاق"})]})}),!m&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{className:"text-black text-2xl font-bold mb-4",children:"سلة التسوق الخاصة بك"}),0===e.length?(0,l.jsx)("div",{className:"text-center mt-8",children:"سلة التسوق الخاصة بك فارغة."}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"grid gap-4",children:e.map((e,t)=>(0,l.jsx)("div",{className:"flex flex-col md:flex-row items-center bg-white shadow-md rounded-lg p-4 mb-4 md:mb-0",children:(0,l.jsxs)("div",{className:"flex md:flex-row flex-row-reverse items-center w-full",children:[e.images&&e.images[0]?(0,l.jsx)("img",{src:(0,r.uH)(e.images[0]).width(100).height(130).url(),alt:e.name,className:"w-24 h-34 rounded-lg mr-4 mb-4 md:mb-0 md:mr-4"}):(0,l.jsx)("div",{className:"w-24 h-24 bg-gray-200 flex items-center justify-center rounded-lg mr-4 mb-4 md:mb-0 md:mr-4",children:"لا توجد صورة"}),(0,l.jsxs)("div",{className:"flex-grow text-right",children:[(0,l.jsxs)("h2",{className:"text-black text-lg mb-2",children:["الإسم: ",e.title||"منتج بدون اسم"]}),(0,l.jsxs)("h2",{className:"text-black text-lg mb-2",children:["الحجم: ",e.size||""]}),(0,l.jsxs)("p",{className:"text-black mb-2",children:["السعر: ",e.price||"غير متوفر"," دينار"]}),(0,l.jsxs)("p",{className:"text-black mb-2",children:["الكمية: ",e.quantity||1]}),(0,l.jsxs)("p",{className:"text-black mb-2",children:["الإجمالي: $",e.price*(e.quantity||1)]}),(0,l.jsx)("button",{onClick:()=>f(t),className:"text-red-500 mt-2",children:"إزالة"})]})]})},t))}),(0,l.jsx)("div",{className:"mt-8 text-right",children:(0,l.jsxs)("h2",{className:"text-black font-bold",children:["الإجمالي: $",g()]})}),(0,l.jsxs)("form",{onSubmit:p,className:"mt-8",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"الاسم"}),(0,l.jsx)("input",{type:"text",value:s,onChange:e=>n(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"العنوان"}),(0,l.jsx)("input",{type:"text",value:c,onChange:e=>i(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"رقم الهاتف"}),(0,l.jsx)("input",{type:"text",value:o,onChange:e=>d(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,l.jsx)("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"تقديم الطلب"})]})]})]})]})})}},3383:function(e,t,s){"use strict";s.d(t,{Lp:function(){return n},uH:function(){return i}});var l=s(8961),a=s(6103),r=s.n(a);let n=(0,l.eI)({projectId:"1pi0qth2",dataset:"production",apiVersion:"2021-03-25",useCdn:!0}),c=r()(n),i=e=>c.image(e)}},function(e){e.O(0,[923,971,23,744],function(){return e(e.s=6579)}),_N_E=e.O()}]);